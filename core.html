<!DOCTYPE html>

<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Ø§Ø³ØªØ¹Ø±Ø§Ø¶ Ø§Ù„Ù…Ù„ÙØ§Øª</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
<script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            primary: {
              50: '#eef2ff',
              100: '#e0e7ff',
              200: '#c7d2fe',
              300: '#a5b4fc',
              400: '#818cf8',
              500: '#6366f1',
              600: '#5D5CDE',
              700: '#4338ca',
              800: '#3730a3',
              900: '#312e81',
              950: '#1e1b4b',
            },
            secondary: {
              50: '#f0f9ff',
              100: '#e0f2fe',
              200: '#bae6fd',
              300: '#7dd3fc',
              400: '#38bdf8',
              500: '#0ea5e9',
              600: '#0284c7',
              700: '#0369a1',
              800: '#075985',
              900: '#0c4a6e',
              950: '#082f49',
            },
            accent: {
              50: '#fdf2f8',
              100: '#fce7f3',
              200: '#fbcfe8',
              300: '#f9a8d4',
              400: '#f472b6',
              500: '#ec4899',
              600: '#db2777',
              700: '#be185d',
              800: '#9d174d',
              900: '#831843',
              950: '#500724',
            },
            success: '#10b981',
            warning: '#f59e0b',
            error: '#ef4444',
            dark: {
              background: '#121212',
              surface: '#1e1e1e',
              border: '#2e2e2e'
            }
          },
          animation: {
            'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'bounce-slow': 'bounce 2s infinite',
          }
        }
      }
    }
  </script>
</head>
<body class="bg-gray-50 text-gray-800 dark:bg-dark-background dark:text-gray-100 min-h-screen transition-colors duration-200">
<!-- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¶Ø¹ Ø§Ù„Ø¸Ù„Ø§Ù… -->
<script>
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      document.documentElement.classList.add('dark');
    }
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
      if (event.matches) {
        document.documentElement.classList.add('dark');
      } else {
        document.documentElement.classList.remove('dark');
      }
    });
  </script>
<!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
<header class="bg-gradient-to-r from-primary-600 to-secondary-600 text-white shadow-lg dark:from-primary-800 dark:to-secondary-800">
<div class="container mx-auto py-6 px-4">
<div class="flex justify-between items-center">
<h1 class="text-2xl md:text-3xl font-bold flex items-center">
<i class="fas fa-folder-open text-yellow-300 mr-3 animate-pulse-slow"></i>
<span class="relative">
            Ø§Ø³ØªØ¹Ø±Ø§Ø¶ Ø§Ù„Ù…Ù„ÙØ§Øª
            <span class="absolute -bottom-1 left-0 w-full h-1 bg-yellow-300 rounded-full opacity-70"></span>
</span>
</h1>
<div class="flex items-center space-x-4 space-x-reverse">
<button class="p-2 rounded-full hover:bg-white/20 transition-colors" id="darkModeToggle">
<i class="fas fa-moon text-xl dark:hidden"></i>
<i class="fas fa-sun text-xl hidden dark:block"></i>
</button>
<a class="flex items-center bg-white/20 hover:bg-white/30 px-3 py-2 rounded-lg transition-colors" href="index.html">
<i class="fas fa-home ml-2"></i>
<span class="hidden md:inline">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
</a>
</div>
</div>
</div>
</header>
<!-- Ù…Ø³Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ -->
<div class="container mx-auto mt-6 px-4">
<div class="bg-white dark:bg-dark-surface rounded-lg shadow p-3 flex flex-wrap items-center text-sm md:text-base overflow-x-auto" id="breadcrumb">
<!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ø³Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
</div>
</div>
<!-- Ù‚Ø³Ù… Ø§Ù„Ø¨Ø­Ø« -->
<div class="container mx-auto mt-4 px-4">
<div class="relative">
<div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
<i class="fas fa-search text-gray-500 dark:text-gray-400"></i>
</div>
<input class="block w-full p-3 pr-10 text-base text-gray-900 border border-gray-300 rounded-lg bg-white focus:ring-primary-600 focus:border-primary-600 dark:bg-dark-surface dark:border-dark-border dark:placeholder-gray-400 dark:text-white" id="searchInput" placeholder="Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©..." type="text"/>
</div>
</div>
<!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
<main class="container mx-auto mt-6 px-4 pb-12">
<!-- Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
<div class="flex flex-col items-center justify-center py-16" id="loadingState">
<div class="w-16 h-16 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"></div>
<p class="mt-4 text-gray-600 dark:text-gray-300">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª...</p>
</div>
<!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù„ÙØ§Øª -->
<div class="hidden" id="fileContent">
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4" id="fileGrid">
<!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù„ÙØ§Øª Ù‡Ù†Ø§ -->
</div>
</div>
<!-- Ø±Ø³Ø§Ù„Ø© Ø¹Ù†Ø¯ Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ù…Ù„ÙØ§Øª -->
<div class="hidden flex flex-col items-center justify-center py-16 text-center" id="emptyMessage">
<div class="text-6xl mb-4 text-gray-400 dark:text-gray-600">
<i class="fas fa-folder-open"></i>
</div>
<h2 class="text-xl font-bold text-gray-700 dark:text-gray-300 mb-2">Ø§Ù„Ù…Ø¬Ù„Ø¯ ÙØ§Ø±Øº</h2>
<p class="text-gray-500 dark:text-gray-400 max-w-md">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„ÙØ§Øª ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¬Ù„Ø¯ Ø£Ùˆ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰.</p>
</div>
<!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ -->
<div class="hidden flex flex-col items-center justify-center py-16 text-center" id="errorMessage">
<div class="text-6xl mb-4 text-error">
<i class="fas fa-exclamation-triangle"></i>
</div>
<h2 class="text-xl font-bold text-gray-700 dark:text-gray-300 mb-2">Ø­Ø¯Ø« Ø®Ø·Ø£</h2>
<p class="text-gray-500 dark:text-gray-400 max-w-md">ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¬Ù„Ø¯. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ø§Ø­Ù‚Ù‹Ø§.</p>
<button class="mt-4 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors" id="retryButton">
<i class="fas fa-redo ml-1"></i>Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©
      </button>
</div>
<!-- Ù…ÙˆØ¯Ø§Ù„ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù -->
<div class="fixed inset-0 bg-black/70 dark:bg-black/80 z-50 flex items-center justify-center hidden" id="fileViewerModal">
<div class="relative bg-white dark:bg-dark-surface rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-hidden">
<div class="flex justify-between items-center p-4 border-b dark:border-dark-border">
<h3 class="font-bold text-lg" id="fileViewerTitle"></h3>
<button class="text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200" id="closeFileViewer">
<i class="fas fa-times text-xl"></i>
</button>
</div>
<div class="p-4 overflow-auto max-h-[calc(90vh-80px)]" id="fileViewerContent">
<!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù„Ù Ù‡Ù†Ø§ -->
</div>
<div class="p-4 border-t dark:border-dark-border flex justify-end">
<a class="bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-lg transition-colors" download="" href="#" id="downloadFileLink">
<i class="fas fa-download ml-1"></i>ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
          </a>
</div>
</div>
</div>
</main>
<!-- Ø§Ù„ÙÙˆØªØ± -->
<footer class="bg-white dark:bg-dark-surface border-t dark:border-dark-border py-4 mt-auto">
<div class="container mx-auto px-4 text-center">
<p class="text-gray-600 dark:text-gray-400">Â© 2025 Ù…Ù†ØµØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>
</div>
</footer>
<!-- Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª -->
<div class="fixed bottom-4 right-4 z-50" id="iconGuide">
<button class="bg-primary-600 hover:bg-primary-700 text-white p-3 rounded-full shadow-lg transition-transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-primary-400 dark:focus:ring-primary-600">
<i class="fas fa-question"></i>
</button>
<div class="absolute bottom-full right-0 mb-2 w-64 p-4 bg-white dark:bg-dark-surface rounded-lg shadow-xl hidden transition-opacity" id="iconGuideContent">
<h3 class="font-bold mb-2 border-b pb-1 dark:border-dark-border">Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª</h3>
<ul class="text-sm space-y-2">
<li class="flex items-center"><i class="fas fa-folder text-yellow-500 ml-2"></i> Ù…Ø¬Ù„Ø¯</li>
<li class="flex items-center"><i class="fas fa-file-pdf text-red-500 ml-2"></i> Ù…Ù„Ù PDF</li>
<li class="flex items-center"><i class="fas fa-file-word text-blue-500 ml-2"></i> Ù…Ù„Ù Word</li>
<li class="flex items-center"><i class="fas fa-file-excel text-green-500 ml-2"></i> Ù…Ù„Ù Excel</li>
<li class="flex items-center"><i class="fas fa-file-powerpoint text-orange-500 ml-2"></i> Ù…Ù„Ù PowerPoint</li>
<li class="flex items-center"><i class="fas fa-file-image text-purple-500 ml-2"></i> ØµÙˆØ±Ø©</li>
<li class="flex items-center"><i class="fas fa-file-alt text-gray-500 ml-2"></i> Ù…Ù„Ù Ù†ØµÙŠ</li>
<li class="flex items-center"><i class="fas fa-file text-gray-400 ml-2"></i> Ù…Ù„Ù Ø¢Ø®Ø±</li>
</ul>
</div>
</div>
<script>
    // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªÙ‡ÙŠØ¦Ø©
    const username = "linnkou";
    const repo = "majani";
    const branch = "main";

    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø±
    const params = new URLSearchParams(window.location.search);
    const path = params.get("path") || "";
    
    // ØªØ­Ø¯ÙŠØ¯ Ø¹Ù†Ø§ØµØ± DOM
    const breadcrumb = document.getElementById("breadcrumb");
    const loadingState = document.getElementById("loadingState");
    const fileContent = document.getElementById("fileContent");
    const fileGrid = document.getElementById("fileGrid");
    const emptyMessage = document.getElementById("emptyMessage");
    const errorMessage = document.getElementById("errorMessage");
    const searchInput = document.getElementById("searchInput");
    const iconGuideButton = document.querySelector("#iconGuide button");
    const iconGuideContent = document.getElementById("iconGuideContent");
    const retryButton = document.getElementById("retryButton");
    const darkModeToggle = document.getElementById("darkModeToggle");
    
    // Ø¹Ù†Ø§ØµØ± DOM Ù„Ù„Ù…ÙˆØ¯Ø§Ù„
    const fileViewerModal = document.getElementById("fileViewerModal");
    const fileViewerTitle = document.getElementById("fileViewerTitle");
    const fileViewerContent = document.getElementById("fileViewerContent");
    const closeFileViewer = document.getElementById("closeFileViewer");
    const downloadFileLink = document.getElementById("downloadFileLink");

    // ØªØ®Ø²ÙŠÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù„ÙØ§Øª ÙˆØ§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª
    let filesData = [];

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª
    function loadFiles() {
      // Ø¥Ø¸Ù‡Ø§Ø± Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
      loadingState.classList.remove("hidden");
      fileContent.classList.add("hidden");
      emptyMessage.classList.add("hidden");
      errorMessage.classList.add("hidden");

      // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³Ø§Ø± API
      const fullPath = "educationdzwordland/" + path;
      const encodedPath = fullPath.split("/").map(encodeURIComponent).join("/");
      const apiUrl = `https://api.github.com/repos/${username}/${repo}/contents/${encodedPath}?ref=${branch}`;

      // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ (breadcrumb)
      setupBreadcrumb();

      // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
      fetch(apiUrl)
        .then(response => {
          if (!response.ok) {
            throw new Error(`Ø§Ø³ØªØ¬Ø§Ø¨Ø© ØºÙŠØ± Ù†Ø§Ø¬Ø­Ø©: ${response.status}`);
          }
          return response.json();
        })
        .then(data => {
          // Ø¥Ø®ÙØ§Ø¡ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
          loadingState.classList.add("hidden");
          
          if (!Array.isArray(data)) {
            // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„ÙŠØ³Øª Ù…ØµÙÙˆÙØ©ØŒ ÙÙ‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù†Ù‡Ø§ Ù…Ù„Ù ÙˆØ§Ø­Ø¯
            handleSingleFile(data);
            return;
          }

          // ØªØµÙÙŠØ© Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø®ÙÙŠØ© ÙˆØªØ®Ø²ÙŠÙ†Ù‡Ø§
          filesData = data.filter(item => !item.name.startsWith('.'));

          if (filesData.length === 0) {
            emptyMessage.classList.remove("hidden");
            return;
          }

          // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
          fileContent.classList.remove("hidden");
          
          // ÙØ±Ø² Ø§Ù„Ø¹Ù†Ø§ØµØ±: Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª Ø£ÙˆÙ„Ø§Ù‹ Ø«Ù… Ø§Ù„Ù…Ù„ÙØ§ØªØŒ ÙˆÙƒÙ„Ø§Ù‡Ù…Ø§ Ù…Ø±ØªØ¨ Ø£Ø¨Ø¬Ø¯ÙŠÙ‹Ø§
          filesData.sort((a, b) => {
            if (a.type !== b.type) {
              return a.type === "dir" ? -1 : 1;
            }
            return a.name.localeCompare(b.name);
          });

          // Ù…Ø³Ø­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ
          fileGrid.innerHTML = '';
          
          // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù†Ø§ØµØ±
          filesData.forEach(item => {
            const card = createFileCard(item);
            fileGrid.appendChild(card);
          });

          // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø¨Ø­Ø«
          setupSearch();
        })
        .catch(error => {
          loadingState.classList.add("hidden");
          errorMessage.classList.remove("hidden");
          console.error("Ø­Ø¯Ø« Ø®Ø·Ø£:", error);
        });
    }

    // Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ù…Ù„Ù
    function createFileCard(item) {
      const card = document.createElement("div");
      card.className = "bg-white dark:bg-dark-surface rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow border border-gray-100 dark:border-dark-border group cursor-pointer";
      card.setAttribute("data-name", item.name.toLowerCase());
      card.setAttribute("data-type", item.type);
      card.setAttribute("data-item-sha", item.sha);
      card.setAttribute("data-item-path", item.path);
      card.setAttribute("data-download-url", item.download_url || "");
      
      // ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù†
      const { icon, bgColor, textColor } = getFileIconAndColors(item);
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
      const cardContent = `
        <div class="${bgColor} ${textColor} p-4 flex justify-center items-center h-32 group-hover:scale-105 transition-transform">
          <i class="${icon} text-5xl transition-transform group-hover:scale-110"></i>
        </div>
        <div class="p-4">
          <h3 class="font-bold text-gray-800 dark:text-gray-100 mb-1 line-clamp-1" title="${item.name}">${item.name}</h3>
          <p class="text-xs text-gray-500 dark:text-gray-400">
            ${item.type === "dir" ? "Ù…Ø¬Ù„Ø¯" : getFileExtension(item.name)}
          </p>
        </div>
      `;
      
      card.innerHTML = cardContent;
      
      // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù†Ù‚Ø± Ù„Ù„Ø¹Ù†ØµØ±
      card.addEventListener('click', () => handleItemClick(item));
      
      return card;
    }

    // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†ØµØ±
    function handleItemClick(item) {
      if (item.type === "dir") {
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø¬Ù„Ø¯ØŒ Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯
        const newPath = path ? path + "/" + item.name : item.name;
        window.location.href = `file-browser.html?path=${encodeURIComponent(newPath)}`;
      } else {
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ù„ÙØŒ Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
        showFileViewer(item);
      }
    }

    // Ø¹Ø±Ø¶ Ù…ÙˆØ¯Ø§Ù„ Ø¹Ø§Ø±Ø¶ Ø§Ù„Ù…Ù„ÙØ§Øª
    function showFileViewer(item) {
      // ØªØ¹ÙŠÙŠÙ† Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ù
      fileViewerTitle.textContent = item.name;
      
      // ØªØ­Ø¯ÙŠØ¯ Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù…ÙŠÙ„
      downloadFileLink.href = item.download_url;
      downloadFileLink.setAttribute('download', item.name);
      
      // ØªØ­Ø¯ÙŠØ¯ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¹Ø§Ø±Ø¶ Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù
      setFileViewerContent(item);
      
      // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
      fileViewerModal.classList.remove('hidden');
      
      // Ù…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
      document.body.style.overflow = 'hidden';
    }

    // ØªØ¹ÙŠÙŠÙ† Ù…Ø­ØªÙˆÙ‰ Ø¹Ø§Ø±Ø¶ Ø§Ù„Ù…Ù„ÙØ§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù
    function setFileViewerContent(item) {
      // Ù…Ø³Ø­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø³Ø§Ø¨Ù‚
      fileViewerContent.innerHTML = '';
      
      // Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
      fileViewerContent.innerHTML = `
        <div class="flex flex-col items-center justify-center py-8">
          <div class="w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"></div>
          <p class="mt-4 text-gray-600 dark:text-gray-300">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù„Ù...</p>
        </div>
      `;
      
      const extension = item.name.split('.').pop().toLowerCase();
      
      // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù Ø­Ø³Ø¨ Ù†ÙˆØ¹Ù‡
      if (['jpg', 'jpeg', 'png', 'gif'].includes(extension)) {
        // ØµÙˆØ±
        const img = document.createElement('img');
        img.src = item.download_url;
        img.className = 'max-w-full h-auto mx-auto';
        img.alt = item.name;
        
        img.onload = () => {
          fileViewerContent.innerHTML = '';
          fileViewerContent.appendChild(img);
        };
        
        img.onerror = () => {
          fileViewerContent.innerHTML = `
            <div class="text-center py-8">
              <div class="text-4xl mb-4 text-error">
                <i class="fas fa-exclamation-triangle"></i>
              </div>
              <p>ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©. ÙŠØ±Ø¬Ù‰ ØªØ¬Ø±Ø¨Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ù…Ø¨Ø§Ø´Ø±Ø©.</p>
            </div>
          `;
        };
      } else if (['mp4', 'webm', 'ogg'].includes(extension)) {
        // ÙÙŠØ¯ÙŠÙˆ
        const video = document.createElement('video');
        video.src = item.download_url;
        video.className = 'max-w-full h-auto mx-auto';
        video.controls = true;
        
        video.onloadeddata = () => {
          fileViewerContent.innerHTML = '';
          fileViewerContent.appendChild(video);
        };
        
        video.onerror = () => {
          fileViewerContent.innerHTML = `
            <div class="text-center py-8">
              <div class="text-4xl mb-4 text-error">
                <i class="fas fa-exclamation-triangle"></i>
              </div>
              <p>ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ. ÙŠØ±Ø¬Ù‰ ØªØ¬Ø±Ø¨Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ù…Ø¨Ø§Ø´Ø±Ø©.</p>
            </div>
          `;
        };
      } else if (['mp3', 'wav'].includes(extension)) {
        // ØµÙˆØª
        const audio = document.createElement('audio');
        audio.src = item.download_url;
        audio.className = 'w-full';
        audio.controls = true;
        
        audio.onloadeddata = () => {
          fileViewerContent.innerHTML = '';
          fileViewerContent.appendChild(audio);
        };
        
        audio.onerror = () => {
          fileViewerContent.innerHTML = `
            <div class="text-center py-8">
              <div class="text-4xl mb-4 text-error">
                <i class="fas fa-exclamation-triangle"></i>
              </div>
              <p>ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ. ÙŠØ±Ø¬Ù‰ ØªØ¬Ø±Ø¨Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ù…Ø¨Ø§Ø´Ø±Ø©.</p>
            </div>
          `;
        };
      } else if (['pdf'].includes(extension)) {
        // Ù…Ù„ÙØ§Øª PDF
        fileViewerContent.innerHTML = `
          <div class="flex flex-col h-[500px]">
            <iframe src="${item.download_url}" class="w-full h-full rounded border dark:border-dark-border"></iframe>
          </div>
        `;
      } else if (['txt', 'md', 'json', 'xml', 'csv', 'html', 'css', 'js'].includes(extension)) {
        // Ù…Ù„ÙØ§Øª Ù†ØµÙŠØ©
        fetch(item.download_url)
          .then(response => response.text())
          .then(text => {
            fileViewerContent.innerHTML = `
              <pre class="bg-gray-100 dark:bg-gray-800 p-4 rounded overflow-x-auto whitespace-pre-wrap">${escapeHtml(text)}</pre>
            `;
          })
          .catch(() => {
            fileViewerContent.innerHTML = `
              <div class="text-center py-8">
                <div class="text-4xl mb-4 text-error">
                  <i class="fas fa-exclamation-triangle"></i>
                </div>
                <p>ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù„Ù. ÙŠØ±Ø¬Ù‰ ØªØ¬Ø±Ø¨Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ù…Ø¨Ø§Ø´Ø±Ø©.</p>
              </div>
            `;
          });
      } else {
        // Ø£Ù†ÙˆØ§Ø¹ Ø£Ø®Ø±Ù‰ Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª
        fileViewerContent.innerHTML = `
          <div class="text-center py-8">
            <div class="text-6xl mb-4 ${getFileIconAndColors(item).textColor}">
              <i class="${getFileIconAndColors(item).icon}"></i>
            </div>
            <p class="text-xl font-bold mb-2">${item.name}</p>
            <p class="mb-4">Ù‡Ø°Ø§ Ø§Ù„Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¹Ø±Ø¶Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø©. ÙŠØ±Ø¬Ù‰ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ù„Ø¹Ø±Ø¶Ù‡.</p>
            <div class="mt-4">
              <button id="viewerDownloadBtn" class="bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-lg transition-colors">
                <i class="fas fa-download ml-1"></i>ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
              </button>
            </div>
          </div>
        `;
        
        // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù†Ù‚Ø± Ù„Ø²Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
        setTimeout(() => {
          const viewerDownloadBtn = document.getElementById("viewerDownloadBtn");
          if (viewerDownloadBtn) {
            viewerDownloadBtn.addEventListener('click', () => {
              downloadFileLink.click();
            });
          }
        }, 100);
      }
    }

    // ØªÙ‡Ø±ÙˆØ¨ Ø§Ù„Ù†Øµ HTML
    function escapeHtml(text) {
      return text
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
    }

    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…Ù„Ù ÙˆØ£Ù„ÙˆØ§Ù†Ù‡
    function getFileIconAndColors(item) {
      if (item.type === "dir") {
        return {
          icon: "fas fa-folder",
          bgColor: "bg-yellow-50 dark:bg-yellow-900/30",
          textColor: "text-yellow-500 dark:text-yellow-400"
        };
      }
      
      const extension = item.name.split('.').pop().toLowerCase();
      
      const fileTypes = {
        pdf: {
          icon: "fas fa-file-pdf",
          bgColor: "bg-red-50 dark:bg-red-900/30",
          textColor: "text-red-500 dark:text-red-400"
        },
        doc: {
          icon: "fas fa-file-word",
          bgColor: "bg-blue-50 dark:bg-blue-900/30",
          textColor: "text-blue-500 dark:text-blue-400"
        },
        docx: {
          icon: "fas fa-file-word",
          bgColor: "bg-blue-50 dark:bg-blue-900/30",
          textColor: "text-blue-500 dark:text-blue-400"
        },
        xls: {
          icon: "fas fa-file-excel",
          bgColor: "bg-green-50 dark:bg-green-900/30",
          textColor: "text-green-500 dark:text-green-400"
        },
        xlsx: {
          icon: "fas fa-file-excel",
          bgColor: "bg-green-50 dark:bg-green-900/30",
          textColor: "text-green-500 dark:text-green-400"
        },
        ppt: {
          icon: "fas fa-file-powerpoint",
          bgColor: "bg-orange-50 dark:bg-orange-900/30",
          textColor: "text-orange-500 dark:text-orange-400"
        },
        pptx: {
          icon: "fas fa-file-powerpoint",
          bgColor: "bg-orange-50 dark:bg-orange-900/30",
          textColor: "text-orange-500 dark:text-orange-400"
        },
        jpg: {
          icon: "fas fa-file-image",
          bgColor: "bg-purple-50 dark:bg-purple-900/30",
          textColor: "text-purple-500 dark:text-purple-400"
        },
        jpeg: {
          icon: "fas fa-file-image",
          bgColor: "bg-purple-50 dark:bg-purple-900/30",
          textColor: "text-purple-500 dark:text-purple-400"
        },
        png: {
          icon: "fas fa-file-image",
          bgColor: "bg-purple-50 dark:bg-purple-900/30",
          textColor: "text-purple-500 dark:text-purple-400"
        },
        gif: {
          icon: "fas fa-file-image",
          bgColor: "bg-purple-50 dark:bg-purple-900/30",
          textColor: "text-purple-500 dark:text-purple-400"
        },
        txt: {
          icon: "fas fa-file-alt",
          bgColor: "bg-gray-50 dark:bg-gray-700/50",
          textColor: "text-gray-500 dark:text-gray-300"
        },
        zip: {
          icon: "fas fa-file-archive",
          bgColor: "bg-yellow-50 dark:bg-yellow-900/30",
          textColor: "text-yellow-600 dark:text-yellow-400"
        },
        rar: {
          icon: "fas fa-file-archive",
          bgColor: "bg-yellow-50 dark:bg-yellow-900/30",
          textColor: "text-yellow-600 dark:text-yellow-400"
        },
        mp3: {
          icon: "fas fa-file-audio",
          bgColor: "bg-blue-50 dark:bg-blue-900/30",
          textColor: "text-blue-500 dark:text-blue-400"
        },
        wav: {
          icon: "fas fa-file-audio",
          bgColor: "bg-blue-50 dark:bg-blue-900/30",
          textColor: "text-blue-500 dark:text-blue-400"
        },
        mp4: {
          icon: "fas fa-file-video",
          bgColor: "bg-red-50 dark:bg-red-900/30",
          textColor: "text-red-500 dark:text-red-400"
        },
        webm: {
          icon: "fas fa-file-video",
          bgColor: "bg-red-50 dark:bg-red-900/30",
          textColor: "text-red-500 dark:text-red-400"
        }
      };
      
      return fileTypes[extension] || {
        icon: "fas fa-file",
        bgColor: "bg-gray-50 dark:bg-gray-800",
        textColor: "text-gray-400 dark:text-gray-500"
      };
    }

    // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ (breadcrumb)
    function setupBreadcrumb() {
      // Ù…Ø³Ø­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø³Ø§Ø¨Ù‚
      breadcrumb.innerHTML = '';
      
      // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³Ø§Ø± ÙØ§Ø±ØºÙ‹Ø§ØŒ Ù„Ø§ Ù†Ø­ØªØ§Ø¬ Ù„Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ Ø¹Ù†Ø§ØµØ±
      if (!path) return;
      
      // ØªÙˆÙ„ÙŠØ¯ Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø±
      const pathParts = path.split('/');
      
      // Ø¥Ø¶Ø§ÙØ© ÙÙ‚Ø· Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£Ø®ÙŠØ± Ù…Ù† Ø§Ù„Ù…Ø³Ø§Ø±
      const lastPart = pathParts[pathParts.length - 1];
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø§Ù„Ù†Øµ
      const folderName = document.createElement('span');
      folderName.className = 'text-gray-800 dark:text-gray-200 font-bold flex items-center';
      folderName.innerHTML = `<i class="fas fa-folder-open text-yellow-500 dark:text-yellow-400 ml-2"></i>${lastPart}`;
      
      breadcrumb.appendChild(folderName);
      
      // ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„ÙƒØ§Ù…Ù„ ÙÙŠ Ø®Ø§ØµÙŠØ© Ù…Ø®ÙÙŠØ© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ø§Ø­Ù‚Ù‹Ø§ Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
      breadcrumb.setAttribute('data-full-path', path);
    }

    // Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø¨Ø­Ø«
    function setupSearch() {
      searchInput.addEventListener('input', function() {
        const query = this.value.trim().toLowerCase();
        const cards = fileGrid.querySelectorAll('div[data-name]');
        
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¨Ø­Ø« ÙØ§Ø±ØºÙ‹Ø§ØŒ Ø£Ø¸Ù‡Ø± ÙƒÙ„ Ø§Ù„Ø¹Ù†Ø§ØµØ±
        if (query === '') {
          cards.forEach(card => card.classList.remove('hidden'));
          return;
        }
        
        // ØªØ·Ø¨ÙŠÙ‚ ØªØµÙÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
        cards.forEach(card => {
          const name = card.getAttribute('data-name');
          if (name.includes(query)) {
            card.classList.remove('hidden');
          } else {
            card.classList.add('hidden');
          }
        });
        
        // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†ØªØ§Ø¦Ø¬
        const visibleCards = fileGrid.querySelectorAll('div[data-name]:not(.hidden)');
        if (visibleCards.length === 0) {
          // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬" Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
          let noResults = fileGrid.querySelector('.no-results');
          if (!noResults) {
            noResults = document.createElement('div');
            noResults.className = 'no-results col-span-full py-8 text-center text-gray-500 dark:text-gray-400';
            noResults.innerHTML = `
              <i class="fas fa-search mb-2 text-3xl"></i>
              <p>Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù€ "${query}"</p>
            `;
            fileGrid.appendChild(noResults);
          } else {
            noResults.querySelector('p').textContent = `Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù€ "${query}"`;
            noResults.classList.remove('hidden');
          }
        } else {
          // Ø¥Ø®ÙØ§Ø¡ Ø±Ø³Ø§Ù„Ø© "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬" Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©
          const noResults = fileGrid.querySelector('.no-results');
          if (noResults) {
            noResults.classList.add('hidden');
          }
        }
      });
    }

    // Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ù„Ù ÙˆØ­ÙŠØ¯ (Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„)
    function handleSingleFile(file) {
      showFileViewer(file);
    }

    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù…ØªØ¯Ø§Ø¯ Ø§Ù„Ù…Ù„Ù
    function getFileExtension(filename) {
      const parts = filename.split('.');
      const extension = parts.length > 1 ? parts.pop().toUpperCase() : '';
      return extension ? `Ù…Ù„Ù ${extension}` : 'Ù…Ù„Ù';
    }

    // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
    function setupEventListeners() {
      // Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©
      retryButton.addEventListener('click', loadFiles);
      
      // Ø²Ø± ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¸Ù„Ù…
      darkModeToggle.addEventListener('click', () => {
        document.documentElement.classList.toggle('dark');
      });
      
      // Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
      iconGuideButton.addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation(); // Ù…Ù†Ø¹ Ø§Ù†ØªØ´Ø§Ø± Ø§Ù„Ø­Ø¯Ø«
        iconGuideContent.classList.toggle('hidden');
      });
      
      // Ø¥Ø®ÙØ§Ø¡ Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡
      document.addEventListener('click', (e) => {
        if (!iconGuide.contains(e.target)) {
          iconGuideContent.classList.add('hidden');
        }
      });
      
      // Ø¥ØºÙ„Ø§Ù‚ Ù…ÙˆØ¯Ø§Ù„ Ø¹Ø§Ø±Ø¶ Ø§Ù„Ù…Ù„ÙØ§Øª
      closeFileViewer.addEventListener('click', () => {
        fileViewerModal.classList.add('hidden');
        document.body.style.overflow = 'auto'; // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ…ÙƒÙŠÙ† Ø§Ù„ØªÙ…Ø±ÙŠØ±
      });
      
      // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
      fileViewerModal.addEventListener('click', (e) => {
        if (e.target === fileViewerModal) {
          fileViewerModal.classList.add('hidden');
          document.body.style.overflow = 'auto';
        }
      });
      
      // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ø¨Ø²Ø± Escape
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && !fileViewerModal.classList.contains('hidden')) {
          fileViewerModal.classList.add('hidden');
          document.body.style.overflow = 'auto';
        }
      });
    }

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
    document.addEventListener('DOMContentLoaded', () => {
      setupEventListeners();
      loadFiles();
    });
  </script>
<script>
  const currentUser = JSON.parse(localStorage.getItem("currentUser") || "null");
  const users = JSON.parse(localStorage.getItem("users") || "[]");
  const found = currentUser ? users.find(u => u.username === currentUser.username && u.password === currentUser.password) : null;
  const isAdmin = currentUser && currentUser.username === "latifking" && currentUser.password === "ding2010";

  if (!found && !isAdmin) {
    window.location.href = "login.html";
  } else if (found && !found.approved) {
    window.location.href = "not-approved.html";
  }

  function logoutUser() {
    localStorage.removeItem("currentUser");
    window.location.href = "login.html";
  }
</script>
<div style="position: fixed; top: 20px; left: 20px; z-index: 999;">
<button onclick="logoutUser()" style="padding: 10px 20px; background: #F44336; color: #fff; border: none; border-radius: 8px; font-weight: bold; cursor: pointer;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
</div>
<script>
  function goToUploadPage(button) {
    const folder = button.previousElementSibling;
    const href = folder.getAttribute("href");
    if (href) {
      const url = new URL(href, window.location.origin);
      url.pathname = "/upload-file-browser.html";
      url.searchParams.set("path", href);
      window.location.href = url.toString();
    }
  }
</script>

<script>
function isUserLoggedIn() {
  const user = JSON.parse(localStorage.getItem("currentUser") || "null");
  return user !== null;
}

function uploadFileToCurrent() {
  const file = document.getElementById("uploadInput").files[0];
  if (!file || (!file.name.endsWith(".doc") && !file.name.endsWith(".docx"))) {
    alert("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Word ÙÙ‚Ø·.");
    return;
  }

  const user = JSON.parse(localStorage.getItem("currentUser") || "null");
  if (!user) {
    alert("ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹.");
    return;
  }

  const files = JSON.parse(localStorage.getItem("browserFiles") || "[]");
  const path = decodeURIComponent(getCurrentPath());

  files.push({
    name: file.name,
    path: path,
    approved: false,
    uploadedBy: user.username
  });

  localStorage.setItem("browserFiles", JSON.stringify(files));
  alert("âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­! Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø£Ø¯Ù…Ù†.");
  document.getElementById("uploadInput").value = "";
  location.reload();
}

document.addEventListener("DOMContentLoaded", () => {
  if (!isUserLoggedIn()) return;

  const uploadZone = document.createElement("div");
  uploadZone.className = "flex flex-col items-center gap-4 mb-6";
  uploadZone.innerHTML = `
    <div class="flex flex-col sm:flex-row gap-3 items-center">
      <input type="file" id="uploadInput" accept=".doc,.docx" class="text-sm">
      <button onclick="uploadFileToCurrent()" class="bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-lg shadow">ğŸ“¤ Ø±ÙØ¹ Ù…Ù„Ù Ø¥Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¬Ù„Ø¯</button>
    </div>
  `;

  const grid = document.getElementById("fileGrid");
  if (grid && grid.parentNode) {
    grid.parentNode.insertBefore(uploadZone, grid);
  }
});
</script>
</body>
</html>
